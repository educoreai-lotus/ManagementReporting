<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EducoreAI Management Reporting</title>
  </head>
  <body>
    <div id="root"></div>
    
    <!-- ✅ EDUCORE BOT - DO NOT MODIFY -->
    <div id="edu-bot-container"></div>
    <!-- ✅ END BOT CONTAINER -->
    
    <!-- ✅ BOT SCRIPT -->
    <script src="https://rag-production-3a4c.up.railway.app/embed/bot.js"></script>
    <!-- ✅ END BOT SCRIPT -->
    
    <!-- ✅ INITIALIZATION -->
    <script>
      // Wait for bot script to load
      window.addEventListener('load', function() {
        // Get user data from localStorage (auth system)
        const token = localStorage.getItem('authToken') || localStorage.getItem('token') || localStorage.getItem('accessToken') || '';
        
        // Extract userId from JWT token if available
        let userId = 'DEV_BOT_USER';
        if (token) {
          try {
            const tokenParts = token.split('.');
            if (tokenParts.length === 3) {
              const payload = JSON.parse(atob(tokenParts[1]));
              userId = payload.userId || payload.sub || payload.id || 'DEV_BOT_USER';
            }
          } catch (error) {
            console.warn('Could not parse JWT token, using fallback user');
          }
        }
        
        // Initialize bot
        if (window.initializeEducoreBot) {
          window.initializeEducoreBot({
            microservice: 'HR_MANAGEMENT_REPORTING',
            userId: userId,
            token: token,
            tenantId: 'default'
          });
        }
      });
    </script>
    <!-- ✅ END INITIALIZATION -->
    
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

